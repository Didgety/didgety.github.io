<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Chladni Plate Particle Simulation | Jai Veilleux </title> <meta name="author" content="Jai Veilleux"> <meta name="description" content="Visualizing some fun physics phenomena"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://didgety.github.io/blog/2023/chladni_plate_simulation/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Jai</span> Veilleux </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">Reading Nook </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Chladni Plate Particle Simulation</h1> <p class="post-meta"> Created on September 20, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Chladni patterns are cool. I first read about them on <a href="https://paulbourke.net/geometry/chladni/" rel="external nofollow noopener" target="_blank">Paul Bourke’s blog</a>. Essentially, they are patterns that arise from certain frequencies on a bounded surface. The classic example is a violin bow pulled across the edge of a metal plate with salt on it.</p> <figure> <iframe src="https://www.youtube.com/embed/lRFysSAxWxI" class="w-100 rounded shadow" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="450"></iframe> </figure> <p>Chladni patterns fall under the umbrella of the field of cymatics. There are similar phenomena that can be observed all over. For example, in fluids there are faraday waves. One of my favorite demonstrations of this branch of physics is this <a href="https://www.youtube.com/watch?v=KijiWlTJp3Y" rel="external nofollow noopener" target="_blank">youtube video</a> which unfortunately does not allow playback when embedded.</p> <p>The equation for Chladni patterns on a rectangular bounded surface is given by:</p> \[\Bigl[\cos\left(\frac{n\pi x}{L}\right)\cdot\cos\left(\frac{m\pi y}{L}\right)\Bigr] - \Bigl[\cos\left(\frac{m\pi x}{L}\right)\cdot\cos\left(\frac{n\pi y}{L}\right)\Bigr] = 0\] <p>This equation was recreated using the <a href="https://derivative.ca/UserGuide/Math_CHOP" rel="external nofollow noopener" target="_blank">Math</a> and <a href="https://docs.derivative.ca/Function_CHOP" rel="external nofollow noopener" target="_blank">Function</a> CHOPs in <a href="https://derivative.ca/" rel="external nofollow noopener" target="_blank">TouchDesigner</a>. Adding two more channels allowed it to be represented as a 2D texture using <a href="https://docs.derivative.ca/CHOP_to_TOP" rel="external nofollow noopener" target="_blank">CHOP to TOP</a>. A few more tweaks to clean up the texture and a nice normal map was created using the <a href="https://docs.derivative.ca/Normal_Map_TOP" rel="external nofollow noopener" target="_blank">Normal Map</a> TOP. The normal map provides the velocity at any given point in the texture.</p> <p>All that’s left is to create a particle system. This was achieved using some noise and a GLSL shader to utilize the information encoded in the normal map that was just created. 2D noise was created with the <a href="https://docs.derivative.ca/Noise_TOP" rel="external nofollow noopener" target="_blank">Noise</a> TOP and fed into a <a href="https://docs.derivative.ca/GLSL_Multi_TOP" rel="external nofollow noopener" target="_blank">GLSL Multi</a> TOP along with a <a href="https://docs.derivative.ca/Feedback_TOP" rel="external nofollow noopener" target="_blank">Feedback</a> TOP.</p> <p>The shader code:</p> <div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">out</span> <span class="kt">vec4</span> <span class="n">fragColor</span><span class="p">;</span>

<span class="k">uniform</span> <span class="kt">float</span> <span class="n">speed</span><span class="p">;</span>

<span class="k">uniform</span> <span class="kt">vec2</span> <span class="n">vel_add</span><span class="p">;</span>
<span class="k">uniform</span> <span class="kt">vec2</span> <span class="n">vel_scalar</span><span class="p">;</span>

<span class="k">uniform</span> <span class="kt">vec2</span> <span class="n">pos_add</span><span class="p">;</span>
<span class="k">uniform</span> <span class="kt">vec2</span> <span class="n">pos_scalar</span><span class="p">;</span>
<span class="k">uniform</span> <span class="kt">vec2</span> <span class="n">pos_add_vel_toggle</span><span class="p">;</span>
<span class="k">uniform</span> <span class="kt">vec2</span> <span class="n">pos_vel_scalar</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// sTD2DInputs are the incoming TOP connections</span>
    <span class="c1">// [0] - Feedback TOP</span>
    <span class="c1">// [1] - Noise TOP (Initial state)</span>
    <span class="c1">// [2] - Normal Map TOP (Provides the velocity information)</span>
	<span class="kt">vec4</span> <span class="n">position</span> <span class="o">=</span> <span class="n">texture</span><span class="p">(</span><span class="n">sTD2DInputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vUV</span><span class="p">.</span><span class="n">st</span><span class="p">);</span>
	<span class="kt">vec4</span> <span class="n">initial</span> <span class="o">=</span> <span class="n">texture</span><span class="p">(</span><span class="n">sTD2DInputs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vUV</span><span class="p">.</span><span class="n">st</span><span class="p">);</span>
	<span class="kt">vec4</span> <span class="n">velocity</span> <span class="o">=</span> <span class="n">texture</span><span class="p">(</span><span class="n">sTD2DInputs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">position</span><span class="p">.</span><span class="n">xy</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span><span class="p">);</span>

	<span class="n">velocity</span> <span class="o">=</span> <span class="n">velocity</span> <span class="o">*</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>

	<span class="kt">vec2</span> <span class="n">derivative</span> <span class="o">=</span> <span class="kt">vec2</span><span class="p">(</span><span class="n">dFdx</span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">r</span><span class="p">),</span> <span class="n">dFdy</span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>

	<span class="c1">// velocity modifier</span>
	<span class="n">velocity</span><span class="p">.</span><span class="n">st</span> <span class="o">+=</span> <span class="n">derivative</span> <span class="o">*</span> <span class="p">.</span><span class="mo">05</span><span class="p">;</span>
	<span class="n">velocity</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">vel_add</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="n">velocity</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">vel_add</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
	<span class="n">velocity</span><span class="p">.</span><span class="n">x</span> <span class="o">*=</span> <span class="n">vel_scalar</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="n">velocity</span><span class="p">.</span><span class="n">y</span> <span class="o">*=</span> <span class="n">vel_scalar</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
	<span class="c1">// position modifiers</span>
	<span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">pos_add</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">pos_add</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
	<span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">*=</span> <span class="n">pos_scalar</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">*=</span> <span class="n">pos_scalar</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>

	<span class="c1">// adds current particle velocity to particle if uniform value is set to 1</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pos_add_vel_toggle</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">velocity</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">pos_vel_scalar</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pos_add_vel_toggle</span><span class="p">.</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">velocity</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">pos_vel_scalar</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">position</span> <span class="o">+=</span> <span class="n">velocity</span> <span class="o">*</span> <span class="n">speed</span><span class="p">;</span>

    <span class="c1">// reset particle position if out of bounds</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="p">.</span><span class="mi">995</span> <span class="o">||</span> <span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">995</span> <span class="o">||</span> <span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="o">-</span><span class="p">.</span><span class="mi">995</span> <span class="o">||</span> <span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">995</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">position</span> <span class="o">=</span> <span class="n">initial</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="n">fragColor</span> <span class="o">=</span> <span class="n">TDOutputSwizzle</span><span class="p">(</span><span class="n">position</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <p>TouchDesigner provides a useful interface for modifying the values of GLSL uniforms through its GUI while also allowing them to be modified in real time through automation. I really love how this program provides the flexibility to experiment rapidly while also providing low level access. There is even a C++ API available for writing custom operators.</p> <p>At this point, I have a 2D texture with all the information needed to create a particle system. Particles can easily be instantiated using the <a href="https://docs.derivative.ca/Add_SOP" rel="external nofollow noopener" target="_blank">Add</a> SOP hooked up to a <a href="https://docs.derivative.ca/Geometry_COMP" rel="external nofollow noopener" target="_blank">Geometry</a> COMP. Hooking up the output from the GLSL Multi TOP in the instantiation menu of the Geometry COMP gives a working particle system. (It’s a little bit more complicated than that, but this isn’t meant to be a TouchDesigner tutorial)</p> <figure> <iframe src="https://www.youtube.com/embed/_lBAmrzcgJ0" class="w-100 rounded shadow" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="450"></iframe> </figure> <p>It’s got a bit of flashing from the automation being applied - but that is used when more effects are applied. The magic of TouchDesigner is layering your components to get really interesting visual effects. After experimenting with this base for a while, I hooked up one of my favorite effects to some music to create an audioreactive animation being rendered in real time. Information was extracted from specific frequencies of the audio to drive different parameters. For example, the kick drum for this song was read slightly below 100Hz to power the pulsing animation change.</p> <p>Resolution is limited since I used the Non-Commercial license of TouchDesigner.</p> <figure> <iframe src="https://www.youtube.com/embed/3auqchAobKA" class="w-100 rounded shadow" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="450"></iframe> </figure> </div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Jai Veilleux. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>